<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Personnels – Collèges publics de Loire-Atlantique (académie de Nantes)</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #f6f8fa;
      --card: #ffffff;
      --text: #222;
      --muted: #555;
      --accent: #2563eb;
      --accent-2: #16a34a;
      --border: #dce3ec;
      --shadow: 0 2px 8px rgba(0,0,0,0.08);
      font-family: system-ui, -apple-system, Segoe UI, sans-serif;
    }
    body {
      margin: 0;
      padding: 32px;
      background: var(--bg);
      color: var(--text);
    }
    h1 { margin: 0 0 8px; font-size: 24px; }
    h2 { margin: 24px 0 12px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
      margin: 16px 0 24px;
    }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 14px 16px;
      box-shadow: var(--shadow);
    }
    .muted { color: var(--muted); font-size: 13px; }
    .value { font-size: 22px; font-weight: 700; }
    .bar-chart {
      display: grid;
      gap: 8px;
    }
    .bar {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .bar-label { width: 220px; font-size: 13px; }
    .bar-track {
      flex: 1;
      background: #e5e7eb;
      border-radius: 8px;
      overflow: hidden;
      height: 14px;
    }
    .bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    th, td {
      padding: 8px;
      border-bottom: 1px solid var(--border);
      text-align: left;
    }
    th {
      position: sticky;
      top: 0;
      background: var(--card);
      z-index: 1;
    }
    tbody tr:hover { background: rgba(37,99,235,0.08); }
    .tag { padding: 2px 8px; border-radius: 999px; font-size: 12px; }
    .tag.public { background: rgba(37,99,235,0.12); color: var(--accent); }
    .tag.prive { background: rgba(16,185,129,0.12); color: #0f766e; }
    .container { max-width: 1300px; margin: 0 auto; }
    .top-bar { display: flex; justify-content: space-between; align-items: baseline; gap: 12px; flex-wrap: wrap; }
    .footnote { font-size: 12px; color: var(--muted); margin-top: 12px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="top-bar">
      <div>
        <h1>Dashboard – Personnels · Collèges publics de Loire-Atlantique (44)</h1>
      </div>
    </div>

    <div id="cards-row1" class="grid"></div>
    <div id="cards-row2" class="grid"></div>
    <div id="cards-row3" class="grid"></div>
    <div id="years" style="margin-top:-8px; margin-bottom:16px;"></div>

    <h2>Vue détaillée</h2>
    <div class="card" style="padding:12px; overflow:auto; max-height:650px;">
      <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
        <input id="filter-text" type="search" placeholder="Filtrer par collège ou commune" style="flex:1; padding:8px; border:1px solid var(--border); border-radius:8px;" />
      </div>
      <table>
        <thead>
          <tr>
            <th data-sort="nom" style="cursor:pointer;">Collège</th>
            <th data-sort="commune" style="cursor:pointer;">Commune</th>
            <th data-sort="eleves" style="cursor:pointer;">Élèves</th>
            <th>Segpa</th>
            <th>ULIS</th>
            <th data-sort="ips" style="cursor:pointer;">IPS</th>
            <th data-sort="ips_ecart" style="cursor:pointer;">Écart-type IPS</th>
            <th data-sort="etp_enseignants" style="cursor:pointer;">Enseignants (ETP)</th>
            <th data-sort="aed_etp" style="cursor:pointer;">Vie scolaire (ETP)</th>
            <th data-sort="ratio" style="cursor:pointer;">Ratio élèves / ETP</th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>
    </div>
    <div class="footnote">
      Note : seuls les établissements publics sont inclus. Les ETP « personnels de vie scolaire » comprennent principalement les AED (surveillants, assistants pédagogiques, assistants de prévention et de sécurité, assistants en préprofessionnalisation, etc.) et peuvent inclure les CPE ou d’autres personnels éducatifs selon la déclaration de l’établissement.
    </div>
    <div class="footnote">
      Sources :
      <ul>
        <li>Les personnels dans les établissements du second degré – <a href="https://www.data.gouv.fr/datasets/les-personnels-dans-les-etablissements-du-second-degre/">data.gouv.fr</a></li>
        <li>Effectifs d’élèves en collège – <a href="https://www.data.gouv.fr/datasets/effectifs-deleves-par-niveau-sexe-langues-vivantes-1-et-2-les-plus-frequentes-par-college-date-dobservation-au-debut-du-mois-doctobre-chaque-annee/">data.gouv.fr</a></li>
        <li>Indices de position sociale des collèges (à partir de 2023) – <a href="https://www.data.gouv.fr/datasets/ips-colleges-a-partir-de-2023/">data.gouv.fr</a></li>
      </ul>
    </div>
  </div>

  <script type="application/json" id="data-json">
{
  "records": [
    {
      "uai": "0440147W",
      "nom": "College Rene Guy Cadou",
      "aed_etp": 8.92,
      "etp_enseignants": 50.18,
      "eleves": 787,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "ANCENIS-SAINT-GEREON",
      "segpa": 59,
      "ulis": 24,
      "ips": 103.4,
      "ips_ecart": 35.3
    },
    {
      "uai": "0440311Z",
      "nom": "College Ernest Renan",
      "aed_etp": 8.2,
      "etp_enseignants": 45.22,
      "eleves": 560,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-HERBLAIN",
      "segpa": 60,
      "ulis": 12,
      "ips": 82.6,
      "ips_ecart": 27.3
    },
    {
      "uai": "0442052S",
      "nom": "College Pierre Abelard",
      "aed_etp": 6.93,
      "etp_enseignants": 40.28,
      "eleves": 649,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "VALLET",
      "segpa": 0,
      "ulis": 12,
      "ips": 111.2,
      "ips_ecart": 31.8
    },
    {
      "uai": "0440289A",
      "nom": "College Jean Mounes",
      "aed_etp": 7.9,
      "etp_enseignants": 36.62,
      "eleves": 592,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "PORNIC",
      "segpa": 0,
      "ulis": 10,
      "ips": 111.3,
      "ips_ecart": 34.1
    },
    {
      "uai": "0442835T",
      "nom": "College Simone Veil",
      "aed_etp": 5.9,
      "etp_enseignants": 34.02,
      "eleves": 534,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 12,
      "ips": 104.5,
      "ips_ecart": 40.2
    },
    {
      "uai": "0442011X",
      "nom": "College La Coutanciere",
      "aed_etp": 5.4,
      "etp_enseignants": 32.84,
      "eleves": 564,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LA CHAPELLE-SUR-ERDRE",
      "segpa": 0,
      "ulis": 12,
      "ips": 127.3,
      "ips_ecart": 38.3
    },
    {
      "uai": "0440350S",
      "nom": "College Albert Vincon",
      "aed_etp": 5.9,
      "etp_enseignants": 31.13,
      "eleves": 503,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-NAZAIRE",
      "segpa": 0,
      "ulis": 12,
      "ips": 109.8,
      "ips_ecart": 34.6
    },
    {
      "uai": "0440049P",
      "nom": "College Aristide Briand",
      "aed_etp": 5.0,
      "etp_enseignants": 32.47,
      "eleves": 473,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 12,
      "ips": 109.4,
      "ips_ecart": 41.7
    },
    {
      "uai": "0440028S",
      "nom": "College La Coliniere",
      "aed_etp": 5.3,
      "etp_enseignants": 32.37,
      "eleves": 521,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 7,
      "ips": 102.2,
      "ips_ecart": 40.9
    },
    {
      "uai": "0440015C",
      "nom": "College Jacques Prevert",
      "aed_etp": 4.6,
      "etp_enseignants": 26.33,
      "eleves": 431,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "HERBIGNAC",
      "segpa": 0,
      "ulis": 0,
      "ips": 98.6,
      "ips_ecart": 30.5
    },
    {
      "uai": "0442921L",
      "nom": "College Camille Lepage",
      "aed_etp": 4.9,
      "etp_enseignants": 27.5,
      "eleves": 421,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LOIREAUXENCE",
      "segpa": 0,
      "ulis": 0,
      "ips": 101.1,
      "ips_ecart": 33.0
    },
    {
      "uai": "0442368K",
      "nom": "College Du Pays Blanc",
      "aed_etp": 4.2,
      "etp_enseignants": 24.22,
      "eleves": 353,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "GUERANDE",
      "segpa": 0,
      "ulis": 9,
      "ips": 108.8,
      "ips_ecart": 31.4
    },
    {
      "uai": "0440010X",
      "nom": "College Paul Langevin",
      "aed_etp": 7.55,
      "etp_enseignants": 51.48,
      "eleves": 894,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "COUERON",
      "segpa": 0,
      "ulis": 0,
      "ips": 110.9,
      "ips_ecart": 36.0
    },
    {
      "uai": "0442029S",
      "nom": "College Gerard Philipe",
      "aed_etp": 8.4,
      "etp_enseignants": 47.29,
      "eleves": 837,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "CARQUEFOU",
      "segpa": 0,
      "ulis": 0,
      "ips": 128.7,
      "ips_ecart": 34.7
    },
    {
      "uai": "0440314C",
      "nom": "College Jean Moulin",
      "aed_etp": 8.7,
      "etp_enseignants": 45.02,
      "eleves": 700,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-NAZAIRE",
      "segpa": 61,
      "ulis": 11,
      "ips": 98.6,
      "ips_ecart": 36.3
    },
    {
      "uai": "0441545R",
      "nom": "College La Noe Lambert",
      "aed_etp": 6.8,
      "etp_enseignants": 46.19,
      "eleves": 657,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 59,
      "ulis": 11,
      "ips": 106.9,
      "ips_ecart": 44.9
    },
    {
      "uai": "0443020U",
      "nom": "College De Nantes Centre",
      "aed_etp": 8.0,
      "etp_enseignants": 41.73,
      "eleves": 676,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 0,
      "ips": 120.4,
      "ips_ecart": 43.1
    },
    {
      "uai": "0441654J",
      "nom": "College Isabelle Autissier",
      "aed_etp": 7.0,
      "etp_enseignants": 43.46,
      "eleves": 694,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NORT-SUR-ERDRE",
      "segpa": 0,
      "ulis": 11,
      "ips": 111.4,
      "ips_ecart": 31.5
    },
    {
      "uai": "0442759K",
      "nom": "College Anita Conti",
      "aed_etp": 6.5,
      "etp_enseignants": 40.7,
      "eleves": 664,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-NAZAIRE",
      "segpa": 0,
      "ulis": 8,
      "ips": 108.4,
      "ips_ecart": 38.4
    },
    {
      "uai": "0442625P",
      "nom": "College Olympe De Gouges Ste Pazanne",
      "aed_etp": 7.8,
      "etp_enseignants": 38.56,
      "eleves": 616,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINTE-PAZANNE",
      "segpa": 0,
      "ulis": 12,
      "ips": 111.6,
      "ips_ecart": 29.8
    },
    {
      "uai": "0442728B",
      "nom": "College Marcelle Baron",
      "aed_etp": 6.2,
      "etp_enseignants": 40.19,
      "eleves": 634,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "HERIC",
      "segpa": 0,
      "ulis": 12,
      "ips": 113.3,
      "ips_ecart": 30.8
    },
    {
      "uai": "0440016D",
      "nom": "College Anne De Bretagne",
      "aed_etp": 6.4,
      "etp_enseignants": 39.61,
      "eleves": 699,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-HERBLAIN",
      "segpa": 0,
      "ulis": 6,
      "ips": 112.7,
      "ips_ecart": 36.1
    },
    {
      "uai": "0441547T",
      "nom": "College Le Grand Beauregard",
      "aed_etp": 5.1,
      "etp_enseignants": 37.77,
      "eleves": 569,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LA CHAPELLE-SUR-ERDRE",
      "segpa": 0,
      "ulis": 11,
      "ips": 131.8,
      "ips_ecart": 36.2
    },
    {
      "uai": "0440292D",
      "nom": "College Jean Mermoz",
      "aed_etp": 5.0,
      "etp_enseignants": 35.16,
      "eleves": 539,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NOZAY",
      "segpa": 0,
      "ulis": 12,
      "ips": 107.0,
      "ips_ecart": 32.1
    },
    {
      "uai": "0442806L",
      "nom": "College Mona Ozouf",
      "aed_etp": 6.3,
      "etp_enseignants": 33.85,
      "eleves": 554,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAVENAY",
      "segpa": 0,
      "ulis": 11,
      "ips": 115.9,
      "ips_ecart": 32.2
    },
    {
      "uai": "0440080Y",
      "nom": "College Jean Monnet",
      "aed_etp": 5.2,
      "etp_enseignants": 33.07,
      "eleves": 543,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "VERTOU",
      "segpa": 0,
      "ulis": 12,
      "ips": 129.3,
      "ips_ecart": 34.5
    },
    {
      "uai": "0440025N",
      "nom": "College Hector Berlioz",
      "aed_etp": 4.9,
      "etp_enseignants": 31.14,
      "eleves": 462,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 12,
      "ips": 113.4,
      "ips_ecart": 43.8
    },
    {
      "uai": "0440285W",
      "nom": "College Gaston Serpette",
      "aed_etp": 5.1,
      "etp_enseignants": 31.91,
      "eleves": 503,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 0,
      "ips": 131.6,
      "ips_ecart": 38.2
    },
    {
      "uai": "0441822S",
      "nom": "College Grand Air",
      "aed_etp": 5.0,
      "etp_enseignants": 30.42,
      "eleves": 498,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LA BAULE-ESCOUBLAC",
      "segpa": 0,
      "ulis": 10,
      "ips": 132.3,
      "ips_ecart": 33.6
    },
    {
      "uai": "0440286X",
      "nom": "College Claude Debussy",
      "aed_etp": 6.5,
      "etp_enseignants": 25.23,
      "eleves": 305,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 0,
      "ips": 74.3,
      "ips_ecart": 27.6
    },
    {
      "uai": "0441862K",
      "nom": "College Louise Michel",
      "aed_etp": 5.1,
      "etp_enseignants": 26.67,
      "eleves": 357,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "PAIMBOEUF",
      "segpa": 52,
      "ulis": 12,
      "ips": 94.4,
      "ips_ecart": 28.8
    },
    {
      "uai": "0440539X",
      "nom": "College Rene Guy Cadou",
      "aed_etp": 5.11,
      "etp_enseignants": 24.62,
      "eleves": 368,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "MONTOIR-DE-BRETAGNE",
      "segpa": 0,
      "ulis": 12,
      "ips": 92.8,
      "ips_ecart": 24.6
    },
    {
      "uai": "0442807M",
      "nom": "College Frida Kahlo",
      "aed_etp": 10.3,
      "etp_enseignants": 54.49,
      "eleves": 776,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "PONTCHATEAU",
      "segpa": 63,
      "ulis": 12,
      "ips": 100.4,
      "ips_ecart": 29.6
    },
    {
      "uai": "0440284V",
      "nom": "College Stendhal",
      "aed_etp": 10.2,
      "etp_enseignants": 43.29,
      "eleves": 531,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 0,
      "ips": 77.3,
      "ips_ecart": 32.7
    },
    {
      "uai": "0440348P",
      "nom": "College La Ville Aux Roses",
      "aed_etp": 8.3,
      "etp_enseignants": 44.23,
      "eleves": 654,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "CHATEAUBRIANT",
      "segpa": 62,
      "ulis": 11,
      "ips": 91.8,
      "ips_ecart": 29.4
    },
    {
      "uai": "0441616T",
      "nom": "College Julien Lambot",
      "aed_etp": 8.48,
      "etp_enseignants": 42.13,
      "eleves": 534,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "TRIGNAC",
      "segpa": 62,
      "ulis": 11,
      "ips": 85.5,
      "ips_ecart": 25.5
    },
    {
      "uai": "0440055W",
      "nom": "College Jean Rostand",
      "aed_etp": 7.1,
      "etp_enseignants": 41.78,
      "eleves": 704,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "ORVAULT",
      "segpa": 0,
      "ulis": 12,
      "ips": 123.1,
      "ips_ecart": 40.5
    },
    {
      "uai": "0442023K",
      "nom": "College Paul Gauguin",
      "aed_etp": 6.1,
      "etp_enseignants": 40.78,
      "eleves": 648,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "CORDEMAIS",
      "segpa": 0,
      "ulis": 13,
      "ips": 115.7,
      "ips_ecart": 34.8
    },
    {
      "uai": "0441610L",
      "nom": "College Gutenberg",
      "aed_etp": 5.6,
      "etp_enseignants": 38.32,
      "eleves": 569,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-HERBLAIN",
      "segpa": 62,
      "ulis": 10,
      "ips": 98.0,
      "ips_ecart": 38.8
    },
    {
      "uai": "0442417N",
      "nom": "College Les Sables D Or",
      "aed_etp": 3.8,
      "etp_enseignants": 36.07,
      "eleves": 604,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "THOUARE-SUR-LOIRE",
      "segpa": 0,
      "ulis": 12,
      "ips": 120.1,
      "ips_ecart": 37.5
    },
    {
      "uai": "0440293E",
      "nom": "College Robert Schuman",
      "aed_etp": 6.0,
      "etp_enseignants": 32.02,
      "eleves": 507,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "CHATEAUBRIANT",
      "segpa": 0,
      "ulis": 12,
      "ips": 93.1,
      "ips_ecart": 28.5
    },
    {
      "uai": "0442781J",
      "nom": "College Rosa Parks",
      "aed_etp": 5.9,
      "etp_enseignants": 32.78,
      "eleves": 506,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "CLISSON",
      "segpa": 0,
      "ulis": 12,
      "ips": 115.3,
      "ips_ecart": 32.0
    },
    {
      "uai": "0441658N",
      "nom": "College Pierre Et Marie Curie",
      "aed_etp": 5.2,
      "etp_enseignants": 32.99,
      "eleves": 524,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LE PELLERIN",
      "segpa": 0,
      "ulis": 5,
      "ips": 111.0,
      "ips_ecart": 31.1
    },
    {
      "uai": "0440018F",
      "nom": "College Raymond Queneau",
      "aed_etp": 5.76,
      "etp_enseignants": 28.23,
      "eleves": 330,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "MACHECOUL-SAINT-MEME",
      "segpa": 60,
      "ulis": 12,
      "ips": 92.1,
      "ips_ecart": 26.8
    },
    {
      "uai": "0440347N",
      "nom": "College Saint Exupery",
      "aed_etp": 5.0,
      "etp_enseignants": 28.55,
      "eleves": 461,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LA MONTAGNE",
      "segpa": 0,
      "ulis": 12,
      "ips": 118.5,
      "ips_ecart": 33.3
    },
    {
      "uai": "0440013A",
      "nom": "College Bellevue",
      "aed_etp": 5.4,
      "etp_enseignants": 28.44,
      "eleves": 400,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "GUEMENE-PENFAO",
      "segpa": 0,
      "ulis": 12,
      "ips": 96.2,
      "ips_ecart": 30.7
    },
    {
      "uai": "0440291C",
      "nom": "College Iles De Loire",
      "aed_etp": 4.7,
      "etp_enseignants": 27.67,
      "eleves": 428,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-SEBASTIEN-SUR-LOIRE",
      "segpa": 0,
      "ulis": 12,
      "ips": 103.2,
      "ips_ecart": 35.0
    },
    {
      "uai": "0441917V",
      "nom": "College La Fontaine",
      "aed_etp": 5.1,
      "etp_enseignants": 22.25,
      "eleves": 364,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "MISSILLAC",
      "segpa": 0,
      "ulis": 11,
      "ips": 95.9,
      "ips_ecart": 27.8
    },
    {
      "uai": "0441655K",
      "nom": "College Louis Pasteur",
      "aed_etp": 5.4,
      "etp_enseignants": 21.91,
      "eleves": 277,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "VALLONS-DE-L'ERDRE",
      "segpa": 0,
      "ulis": 12,
      "ips": 93.8,
      "ips_ecart": 29.3
    },
    {
      "uai": "0441612N",
      "nom": "College Pierre De Coubertin",
      "aed_etp": 3.8,
      "etp_enseignants": 16.9,
      "eleves": 215,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LEGE",
      "segpa": 0,
      "ulis": 0,
      "ips": 98.6,
      "ips_ecart": 29.2
    },
    {
      "uai": "0441548U",
      "nom": "College Rene Bernier",
      "aed_etp": 9.0,
      "etp_enseignants": 51.94,
      "eleves": 849,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-SEBASTIEN-SUR-LOIRE",
      "segpa": 58,
      "ulis": 0,
      "ips": 114.8,
      "ips_ecart": 40.3
    },
    {
      "uai": "0441724K",
      "nom": "College La Reinetiere",
      "aed_etp": 6.73,
      "etp_enseignants": 44.8,
      "eleves": 664,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINTE-LUCE-SUR-LOIRE",
      "segpa": 63,
      "ulis": 12,
      "ips": 104.4,
      "ips_ecart": 40.9
    },
    {
      "uai": "0440065G",
      "nom": "College Petite Lande",
      "aed_etp": 7.0,
      "etp_enseignants": 43.53,
      "eleves": 745,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "REZE",
      "segpa": 0,
      "ulis": 0,
      "ips": 113.9,
      "ips_ecart": 35.7
    },
    {
      "uai": "0441657M",
      "nom": "College Antoine De Saint Exupery",
      "aed_etp": 6.0,
      "etp_enseignants": 37.24,
      "eleves": 578,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAVENAY",
      "segpa": 62,
      "ulis": 0,
      "ips": 113.5,
      "ips_ecart": 34.0
    },
    {
      "uai": "0441686U",
      "nom": "College Auguste Mailloux",
      "aed_etp": 6.0,
      "etp_enseignants": 36.55,
      "eleves": 562,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LE LOROUX-BOTTEREAU",
      "segpa": 0,
      "ulis": 12,
      "ips": 116.5,
      "ips_ecart": 32.5
    },
    {
      "uai": "0442542Z",
      "nom": "College Andree Chedid",
      "aed_etp": 6.3,
      "etp_enseignants": 36.57,
      "eleves": 595,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "AIGREFEUILLE-SUR-MAINE",
      "segpa": 0,
      "ulis": 12,
      "ips": 110.2,
      "ips_ecart": 31.7
    },
    {
      "uai": "0440066H",
      "nom": "College Helene Et Rene Guy Cadou",
      "aed_etp": 7.17,
      "etp_enseignants": 34.0,
      "eleves": 535,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-BREVIN-LES-PINS",
      "segpa": 0,
      "ulis": 12,
      "ips": 110.8,
      "ips_ecart": 31.9
    },
    {
      "uai": "0442277L",
      "nom": "College De Goulaine",
      "aed_etp": 6.0,
      "etp_enseignants": 34.1,
      "eleves": 533,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "BASSE-GOULAINE",
      "segpa": 0,
      "ulis": 0,
      "ips": 128.9,
      "ips_ecart": 33.1
    },
    {
      "uai": "0441859G",
      "nom": "College Eric Tabarly",
      "aed_etp": 5.0,
      "etp_enseignants": 31.74,
      "eleves": 451,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LA BAULE-ESCOUBLAC",
      "segpa": 60,
      "ulis": 0,
      "ips": 114.7,
      "ips_ecart": 35.1
    },
    {
      "uai": "0442595G",
      "nom": "College Lucie Aubrac",
      "aed_etp": 5.3,
      "etp_enseignants": 32.56,
      "eleves": 511,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "VERTOU",
      "segpa": 0,
      "ulis": 12,
      "ips": 123.6,
      "ips_ecart": 32.5
    },
    {
      "uai": "0441728P",
      "nom": "College Rene Char",
      "aed_etp": 5.0,
      "etp_enseignants": 18.74,
      "eleves": 278,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-JOACHIM",
      "segpa": 0,
      "ulis": 0,
      "ips": 99.4,
      "ips_ecart": 29.5
    },
    {
      "uai": "0440061C",
      "nom": "College Jules Verne",
      "aed_etp": 3.5,
      "etp_enseignants": 15.24,
      "eleves": 210,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LE POULIGUEN",
      "segpa": 0,
      "ulis": 7,
      "ips": 104.9,
      "ips_ecart": 29.8
    },
    {
      "uai": "0440023L",
      "nom": "College Chantenay",
      "aed_etp": 8.7,
      "etp_enseignants": 49.91,
      "eleves": 816,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 51,
      "ulis": 24,
      "ips": 120.9,
      "ips_ecart": 44.2
    },
    {
      "uai": "0440316E",
      "nom": "College Marie Marvingt",
      "aed_etp": 7.1,
      "etp_enseignants": 45.93,
      "eleves": 685,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "BOUGUENAIS",
      "segpa": 62,
      "ulis": 12,
      "ips": 107.0,
      "ips_ecart": 35.4
    },
    {
      "uai": "0440045K",
      "nom": "College Victor Hugo",
      "aed_etp": 8.5,
      "etp_enseignants": 43.41,
      "eleves": 707,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 13,
      "ips": 129.5,
      "ips_ecart": 40.6
    },
    {
      "uai": "0441613P",
      "nom": "College Pierre Norange",
      "aed_etp": 6.8,
      "etp_enseignants": 41.1,
      "eleves": 447,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-NAZAIRE",
      "segpa": 63,
      "ulis": 12,
      "ips": 69.8,
      "ips_ecart": 22.8
    },
    {
      "uai": "0440308W",
      "nom": "College Alice Milliat",
      "aed_etp": 6.55,
      "etp_enseignants": 43.68,
      "eleves": 605,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "BLAIN",
      "segpa": 92,
      "ulis": 12,
      "ips": 100.7,
      "ips_ecart": 29.9
    },
    {
      "uai": "0442691L",
      "nom": "College Agnes Varda",
      "aed_etp": 8.0,
      "etp_enseignants": 41.5,
      "eleves": 712,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "LIGNE",
      "segpa": 0,
      "ulis": 9,
      "ips": 113.2,
      "ips_ecart": 32.2
    },
    {
      "uai": "0441858F",
      "nom": "College Bellestre",
      "aed_etp": 8.75,
      "etp_enseignants": 40.28,
      "eleves": 677,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "BOUAYE",
      "segpa": 0,
      "ulis": 12,
      "ips": 116.4,
      "ips_ecart": 34.2
    },
    {
      "uai": "0442418P",
      "nom": "College Le Haut Gesvres",
      "aed_etp": 6.2,
      "etp_enseignants": 42.55,
      "eleves": 724,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "TREILLIERES",
      "segpa": 0,
      "ulis": 0,
      "ips": 125.4,
      "ips_ecart": 33.2
    },
    {
      "uai": "0440008V",
      "nom": "College Cacault",
      "aed_etp": 6.9,
      "etp_enseignants": 37.38,
      "eleves": 552,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "CLISSON",
      "segpa": 51,
      "ulis": 12,
      "ips": 113.2,
      "ips_ecart": 34.2
    },
    {
      "uai": "0440534S",
      "nom": "College Salvador Allende",
      "aed_etp": 6.0,
      "etp_enseignants": 36.17,
      "eleves": 544,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "REZE",
      "segpa": 58,
      "ulis": 12,
      "ips": 99.3,
      "ips_ecart": 39.9
    },
    {
      "uai": "0440538W",
      "nom": "College Jacques Brel",
      "aed_etp": 5.8,
      "etp_enseignants": 36.61,
      "eleves": 592,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "GUERANDE",
      "segpa": 0,
      "ulis": 6,
      "ips": 109.0,
      "ips_ecart": 31.0
    },
    {
      "uai": "0440536U",
      "nom": "College Sophie Germain",
      "aed_etp": 7.3,
      "etp_enseignants": 34.51,
      "eleves": 449,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 0,
      "ulis": 0,
      "ips": 93.6,
      "ips_ecart": 39.0
    },
    {
      "uai": "0441608J",
      "nom": "College La Durantiere",
      "aed_etp": 6.0,
      "etp_enseignants": 29.88,
      "eleves": 348,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 47,
      "ulis": 20,
      "ips": 77.3,
      "ips_ecart": 30.8
    },
    {
      "uai": "0440283U",
      "nom": "College Libertaire Rutigliano",
      "aed_etp": 5.6,
      "etp_enseignants": 31.75,
      "eleves": 448,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "NANTES",
      "segpa": 53,
      "ulis": 0,
      "ips": 94.9,
      "ips_ecart": 38.3
    },
    {
      "uai": "0440064F",
      "nom": "College Pont Rousseau",
      "aed_etp": 5.9,
      "etp_enseignants": 32.45,
      "eleves": 519,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "REZE",
      "segpa": 0,
      "ulis": 0,
      "ips": 115.4,
      "ips_ecart": 40.2
    },
    {
      "uai": "0442782K",
      "nom": "College Julie Victoire Daubie",
      "aed_etp": 5.43,
      "etp_enseignants": 27.88,
      "eleves": 444,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-PHILBERT-DE-GRAND-LIEU",
      "segpa": 0,
      "ulis": 11,
      "ips": 109.0,
      "ips_ecart": 32.3
    },
    {
      "uai": "0440287Y",
      "nom": "College Le Herault",
      "aed_etp": 5.6,
      "etp_enseignants": 27.63,
      "eleves": 449,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-HERBLAIN",
      "segpa": 0,
      "ulis": 12,
      "ips": 111.2,
      "ips_ecart": 38.1
    },
    {
      "uai": "0442186M",
      "nom": "College Condorcet",
      "aed_etp": 4.2,
      "etp_enseignants": 27.72,
      "eleves": 394,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "SAINT-PHILBERT-DE-GRAND-LIEU",
      "segpa": 0,
      "ulis": 12,
      "ips": 109.9,
      "ips_ecart": 32.4
    },
    {
      "uai": "0441727N",
      "nom": "College Arthur Rimbaud",
      "aed_etp": 5.6,
      "etp_enseignants": 26.72,
      "eleves": 360,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "DONGES",
      "segpa": 0,
      "ulis": 10,
      "ips": 89.8,
      "ips_ecart": 24.2
    },
    {
      "uai": "0443021V",
      "nom": "College De Chaumes En Retz",
      "aed_etp": 3.8,
      "etp_enseignants": 17.46,
      "eleves": 279,
      "secteur": "Public",
      "effectifs_annee": "2024",
      "commune": "CHAUMES-EN-RETZ",
      "segpa": 0,
      "ulis": 0,
      "ips": 101.7,
      "ips_ecart": 29.2
    }
  ],
  "summary": {
    "nb_colleges": 82,
    "aed_total": 513.68,
    "aed_moyen": 6.26,
    "aed_min": 3.5,
    "aed_max": 10.3,
    "etp_ens_total": 2901.61,
    "etp_ens_moyen": 35.39,
    "eleves_total": 44451,
    "segpa_total": 1320,
    "ulis_total": 722,
    "ips_moyen": 107.4,
    "ips_min": 69.8,
    "ips_max": 132.3,
    "annee_indic": "2024",
    "annee_eff": "2024",
    "annee_ips": "2024-2025"
  }
}
  </script>

  <script>
    const payload = JSON.parse(document.getElementById('data-json').textContent);
    const records = payload.records;
    const summary = payload.summary;

    const formatNumber = (n) => n === null || n === undefined ? 'n.d.' : new Intl.NumberFormat('fr-FR').format(n);
    const formatFloat = (n) => n === null || n === undefined ? 'n.d.' : new Intl.NumberFormat('fr-FR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(n);

    const ratioElevesParAed = summary.aed_total && summary.eleves_total
      ? summary.eleves_total / summary.aed_total
      : null;

    const cardsRow1 = [
      { label: 'Collèges', value: summary.nb_colleges },
      { label: 'IPS moyen', value: formatFloat(summary.ips_moyen) },
      { label: 'IPS min / max', value: `${formatFloat(summary.ips_min)} / ${formatFloat(summary.ips_max)}` },
    ];
    const cardsRow2 = [
      { label: 'Élèves (total)', value: formatNumber(summary.eleves_total) },
      { label: 'Segpa total', value: formatNumber(summary.segpa_total) },
      { label: 'ULIS total', value: formatNumber(summary.ulis_total) },
      { label: 'Enseignants · Total ETP', value: formatFloat(summary.etp_ens_total) },
    ];
    const cardsRow3 = [
      { label: 'Vie scolaire · Total ETP', value: formatFloat(summary.aed_total) },
      { label: 'Vie scolaire · ETP moyen', value: formatFloat(summary.aed_moyen) },
      { label: 'Vie scolaire · Min / Max ETP', value: `${formatFloat(summary.aed_min)} / ${formatFloat(summary.aed_max)}` },
      { label: 'Vie scolaire · Élèves par ETP', value: ratioElevesParAed ? formatFloat(ratioElevesParAed) : 'n.d.' },
    ];

    const renderCards = (rootId, items) => {
      const root = document.getElementById(rootId);
      root.innerHTML = items.map(c => `
        <div class="card">
          <div class="muted">${c.label}</div>
          <div class="value">${c.value}</div>
        </div>
      `).join('');
    };

    renderCards('cards-row1', cardsRow1);
    renderCards('cards-row2', cardsRow2);
    renderCards('cards-row3', cardsRow3);

    const yearsRoot = document.getElementById('years');
    yearsRoot.innerHTML = `
      <div class="muted">
        Années sources : personnels ${summary.annee_indic || 'n.d.'} · effectifs ${summary.annee_eff || 'n.d.'} · IPS ${summary.annee_ips || 'n.d.'}
      </div>
    `;

    const tbody = document.getElementById('table-body');
    const filterInput = document.getElementById('filter-text');
    const headers = Array.from(document.querySelectorAll('th[data-sort]'));

    let sortKey = 'aed_etp';
    let sortDir = 'desc';

    const baseRows = records.map(r => ({ 
      ...r,
      ratio: (typeof r.eleves === 'number' && typeof r.aed_etp === 'number' && r.aed_etp > 0)
        ? r.eleves / r.aed_etp
        : null,
    }));

    const applySort = (rows) => {
      const dir = sortDir === 'asc' ? 1 : -1;
      return rows.slice().sort((a, b) => {
        const av = a[sortKey];
        const bv = b[sortKey];
        if (av === null || av === undefined) return 1;
        if (bv === null || bv === undefined) return -1;
        if (av < bv) return -1 * dir;
        if (av > bv) return 1 * dir;
        return 0;
      });
    };

    const applyFilter = () => {
      const q = (filterInput.value || '').toLowerCase();
      return baseRows.filter(r => {
        if (!q) return true;
        return (r.nom || '').toLowerCase().includes(q) || (r.commune || '').toLowerCase().includes(q);
      });
    };

    const renderTable = () => {
      const filtered = applyFilter();
      const sorted = applySort(filtered);
      tbody.innerHTML = sorted.map(r => `
        <tr>
          <td>${r.nom}</td>
          <td>${r.commune || 'n.d.'}</td>
          <td>${formatNumber(r.eleves)}</td>
          <td>${formatNumber(r.segpa)}</td>
          <td>${formatNumber(r.ulis)}</td>
          <td>${formatFloat(r.ips)}</td>
          <td>${formatFloat(r.ips_ecart)}</td>
          <td>${formatFloat(r.etp_enseignants)}</td>
          <td>${formatFloat(r.aed_etp)}</td>
          <td>${formatFloat(r.ratio)}</td>
        </tr>
      `).join('');
    };

    headers.forEach(h => {
      h.addEventListener('click', () => {
        const key = h.getAttribute('data-sort');
        if (sortKey === key) {
          sortDir = sortDir === 'asc' ? 'desc' : 'asc';
        } else {
          sortKey = key;
          sortDir = key === 'nom' || key === 'commune' ? 'asc' : 'desc';
        }
        renderTable();
      });
    });

    filterInput.addEventListener('input', renderTable);
    renderTable();
  </script>
</body>
</html>
